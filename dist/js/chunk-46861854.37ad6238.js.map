{"version":3,"sources":["webpack:///./src/api/auth.ts","webpack:///./src/module/auth.ts","webpack:///./src/views/profile/Setting.vue?e5c6","webpack:///./src/views/profile/Setting.vue","webpack:///./src/views/profile/Setting.vue?9f9b","webpack:///./src/views/profile/Setting.vue?d64a"],"names":["LOGIN_API","data","ajax","post","login","res","msg","code","success","store","dispatch","updateUser","localStorage","setItem","tokenName","token","type","Promise","resolve","console","log","logout","removeItem","User","updateTasks","register","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","onNavBarClickLeft","onCleanCacheClick","onSetRefreshRateCellClick","onLogoutClick","_v","model","value","callback","$$v","isSetRatePopup","expression","refreshRates","onSetRefreshCfmClick","staticRenderFns","extend","name","methods","cleanCache","confirm","title","message","then","catch","e","setRefreshRate","$router","replace","task","component"],"mappings":"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","file":"js/chunk-46861854.37ad6238.js","sourcesContent":["import { BASE_API } from './index'\r\nimport { AjaxResponseI, LoginReqI } from '@/interface/ajax'\r\nimport ajax from '@/util/ajax'\r\nimport { UserI } from '@/interface/model'\r\n\r\nconst LOGIN_API = `${ BASE_API }/auth`\r\n\r\nexport const LOGIN = (data: LoginReqI): Promise<AjaxResponseI<UserI>> => ajax.post(`${ LOGIN_API }/login`, data)\r\nexport const REGISTER = (data: LoginReqI): Promise<AjaxResponseI<UserI>> => ajax.post(`${ LOGIN_API }/register`, data)\r\n","import { LoginReqI } from '@/interface/ajax'\r\nimport { LOGIN, REGISTER } from '@/api/auth'\r\nimport { Toast } from 'vant'\r\nimport {MSG_TYPE, RES_CODE} from '@/constant'\r\nimport store from '@/store'\r\nimport { ACTIONS_E } from '@/store/actions'\r\nimport CONFIG from '@/config'\r\nimport User from '@/models/User'\r\nimport { postMessage } from '@/worker/alarm'\r\n\r\nexport default {\r\n  async login (data: LoginReqI) {\r\n    try {\r\n      const res = await LOGIN(data)\r\n      Toast(res.msg)\r\n      if (res.code === RES_CODE.success) {\r\n        await store.dispatch(ACTIONS_E.updateUser, res.data)\r\n        localStorage.setItem(CONFIG.tokenName, res.data.token)\r\n        postMessage<string>({ type: MSG_TYPE.token, msg: res.data.token })\r\n      }\r\n      return Promise.resolve(res.code === RES_CODE.success)\r\n    } catch (e) {\r\n      console.log(e)\r\n      return Promise.resolve(false)\r\n    }\r\n  },\r\n  async logout () {\r\n    localStorage.removeItem(CONFIG.tokenName)\r\n    await store.dispatch(ACTIONS_E.updateUser, new User())\r\n    await store.dispatch(ACTIONS_E.updateTasks, [])\r\n    return Promise.resolve(true)\r\n  },\r\n  async register (data: LoginReqI) {\r\n    try {\r\n      const res = await REGISTER(data)\r\n      Toast(res.msg)\r\n      return Promise.resolve(res.code === RES_CODE.success)\r\n    } catch (e) {\r\n      console.log(e)\r\n      return Promise.resolve(false)\r\n    }\r\n  }\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('van-nav-bar',{attrs:{\"left-text\":\"设置\",\"left-arrow\":\"\"},on:{\"click-left\":_vm.onNavBarClickLeft}}),_c('van-cell',{attrs:{\"title\":\"清除缓存\",\"is-link\":\"\"},on:{\"click\":_vm.onCleanCacheClick}}),_c('van-cell',{attrs:{\"title\":\"任务提醒灵敏度\",\"value\":\"1min\",\"is-link\":\"\"},on:{\"click\":_vm.onSetRefreshRateCellClick}}),_c('br'),_c('br'),_c('van-button',{attrs:{\"type\":\"primary\",\"size\":\"large\"},on:{\"click\":_vm.onLogoutClick}},[_vm._v(\"退出登录\")]),_c('van-popup',{attrs:{\"closeable\":\"\",\"close-icon-position\":\"top-left\",\"round\":\"\",\"position\":\"bottom\"},model:{value:(_vm.isSetRatePopup),callback:function ($$v) {_vm.isSetRatePopup=$$v},expression:\"isSetRatePopup\"}},[_c('van-picker',{attrs:{\"show-toolbar\":\"\",\"title\":\"选择刷新间隔(min)\",\"columns\":_vm.refreshRates},on:{\"confirm\":_vm.onSetRefreshCfmClick}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Vue from 'vue'\r\nimport { Dialog } from 'vant'\r\nimport AuthModule from '@/module/auth'\r\nimport { ROUTES_MAP } from '@/router'\r\nimport { postMessage } from '@/worker/alarm'\r\nimport { MSG_TYPE } from '@/constant'\r\n\r\nexport default Vue.extend({\r\n  name: 'setting',\r\n  data () {\r\n    return {\r\n      isSetRatePopup: false,\r\n      refreshRates: [1, 5, 10]\r\n    }\r\n  },\r\n  methods: {\r\n    cleanCache () {},\r\n    onCleanCacheClick () {\r\n      Dialog.confirm({\r\n        title: '提示',\r\n        message: '确定清除缓存吗?'\r\n      }).then(this.cleanCache).catch(() => {})\r\n    },\r\n    onSetRefreshRateCellClick () {\r\n      this.isSetRatePopup = true\r\n    },\r\n    onSetRefreshCfmClick (e: number) {\r\n      this.isSetRatePopup = false\r\n      postMessage<number>({ type: MSG_TYPE.setRefreshRate, msg: e })\r\n    },\r\n    async onLogoutClick () {\r\n      try {\r\n        Dialog.confirm({\r\n          title: '提示',\r\n          message: '确定退出登录吗?'\r\n        }).then(async () => {\r\n          const res = await AuthModule.logout()\r\n          if (res) await this.$router.replace(ROUTES_MAP.task)\r\n        }).catch(() => {})\r\n      } catch (e) {\r\n        console.log(e)\r\n      }\r\n    }\r\n  }\r\n})\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Setting.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Setting.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Setting.vue?vue&type=template&id=d5322cfa&\"\nimport script from \"./Setting.vue?vue&type=script&lang=ts&\"\nexport * from \"./Setting.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}