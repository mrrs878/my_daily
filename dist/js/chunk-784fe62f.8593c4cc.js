(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-784fe62f"],{"0fee":function(t,e,n){},2221:function(t,e,n){},"26f2":function(t,e,n){},3647:function(t,e,n){"use strict";n("68ef"),n("9d70"),n("3743"),n("1a04"),n("5c56"),n("0fee")},"7e88":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container footer"},[n("van-pull-refresh",{on:{refresh:t.onTaskRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[n("div",{staticStyle:{overflow:"scroll"}},[t._l(t.tasks,(function(e,i){return n("van-swipe-cell",{key:e.ID,staticClass:"task-cell",attrs:{disabled:e.status===t.TASK_STATUS.cancel||e.status===t.TASK_STATUS.failed},on:{open:t.onSwipeCellOpen,close:t.onSwipeCellClose}},[n("van-cell",{attrs:{title:e.title,value:e.detail,center:"",clickable:""},on:{click:function(e){return t.onTaskClick(i)}}},[n("van-icon",{staticClass:"task-status-icon",class:{active:2===e.status},attrs:{slot:"icon",name:"thumb-circle-o",size:"16"},slot:"icon"})],1),n("template",{slot:"right"},[e.status!==t.TASK_STATUS.cancel?n("van-button",{attrs:{square:"",type:"danger",text:"取消"},on:{click:function(n){return t.onSwipeRightClick(t.TASK_STATUS.cancel,e.ID)}}}):t._e(),e.status!==t.TASK_STATUS.running?n("van-button",{attrs:{square:"",type:"info",text:"进行中"},on:{click:function(n){return t.onSwipeRightClick(t.TASK_STATUS.running,e.ID)}}}):t._e(),e.status!==t.TASK_STATUS.complete?n("van-button",{attrs:{square:"",type:"primary",text:"已完成"},on:{click:function(n){return t.onSwipeRightClick(t.TASK_STATUS.complete,e.ID)}}}):t._e()],1)],2)})),n("div",{directives:[{name:"show",rawName:"v-show",value:0===t.tasks.length,expression:"tasks.length === 0"}],staticClass:"empty"},[t._v("空空如也~")])],2)]),n("van-calendar",{attrs:{"default-date":t.defaultDate,"min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.onCalendarConfirm},model:{value:t.isCalendar,callback:function(e){t.isCalendar=e},expression:"isCalendar"}}),n("van-button",{staticClass:"position-bottom footer",attrs:{type:"primary",size:"large"},on:{click:t.onAddTaskClick}},[t._v("添加任务")])],1)},s=[],a=(n("99af"),n("b0c0"),n("5530")),r=n("ade3"),o=(n("96cf"),n("1da1")),l=n("2b0e"),c=n("ea47"),u=(n("3647"),n("d282")),h=n("482d"),f=n("1325"),d=n("3875"),g=function(t){return l["a"].extend({props:{closeOnClickOutside:{type:Boolean,default:!0}},data:function(){var e=this,n=function(n){e.closeOnClickOutside&&!e.$el.contains(n.target)&&e[t.method]()};return{clickOutsideHandler:n}},mounted:function(){Object(f["b"])(document,t.event,this.clickOutsideHandler)},beforeDestroy:function(){Object(f["a"])(document,t.event,this.clickOutsideHandler)}})},p=Object(u["a"])("swipe-cell"),m=p[0],v=p[1],b=.15,y=m({mixins:[d["a"],g({event:"touchstart",method:"onClick"})],props:{onClose:Function,disabled:Boolean,leftWidth:[Number,String],rightWidth:[Number,String],beforeClose:Function,stopPropagation:Boolean,name:{type:[Number,String],default:""}},data:function(){return{offset:0,dragging:!1}},computed:{computedLeftWidth:function(){return+this.leftWidth||this.getWidthByRef("left")},computedRightWidth:function(){return+this.rightWidth||this.getWidthByRef("right")}},mounted:function(){this.bindTouchEvent(this.$el)},methods:{getWidthByRef:function(t){if(this.$refs[t]){var e=this.$refs[t].getBoundingClientRect();return e.width}return 0},open:function(t){var e="left"===t?this.computedLeftWidth:-this.computedRightWidth;this.opened=!0,this.offset=e,this.$emit("open",{position:t,name:this.name,detail:this.name})},close:function(t){this.offset=0,this.opened&&(this.opened=!1,this.$emit("close",{position:t,name:this.name}))},onTouchStart:function(t){this.disabled||(this.startOffset=this.offset,this.touchStart(t))},onTouchMove:function(t){if(!this.disabled&&(this.touchMove(t),"horizontal"===this.direction)){this.dragging=!0,this.lockClick=!0;var e=!this.opened||this.deltaX*this.startOffset<0;e&&Object(f["c"])(t,this.stopPropagation),this.offset=Object(h["a"])(this.deltaX+this.startOffset,-this.computedRightWidth,this.computedLeftWidth)}},onTouchEnd:function(){var t=this;this.disabled||this.dragging&&(this.toggle(this.offset>0?"left":"right"),this.dragging=!1,setTimeout((function(){t.lockClick=!1}),0))},toggle:function(t){var e=Math.abs(this.offset),n=this.opened?1-b:b,i=this.computedLeftWidth,s=this.computedRightWidth;s&&"right"===t&&e>s*n?this.open("right"):i&&"left"===t&&e>i*n?this.open("left"):this.close()},onClick:function(t){void 0===t&&(t="outside"),this.$emit("click",t),this.opened&&!this.lockClick&&(this.beforeClose?this.beforeClose({position:t,name:this.name,instance:this}):this.onClose?this.onClose(t,this,{name:this.name}):this.close(t))},getClickHandler:function(t,e){var n=this;return function(i){e&&i.stopPropagation(),n.onClick(t)}},genLeftPart:function(){var t=this.$createElement,e=this.slots("left");if(e)return t("div",{ref:"left",class:v("left"),on:{click:this.getClickHandler("left",!0)}},[e])},genRightPart:function(){var t=this.$createElement,e=this.slots("right");if(e)return t("div",{ref:"right",class:v("right"),on:{click:this.getClickHandler("right",!0)}},[e])}},render:function(){var t=arguments[0],e={transform:"translate3d("+this.offset+"px, 0, 0)",transitionDuration:this.dragging?"0s":".6s"};return t("div",{class:v(),on:{click:this.getClickHandler("cell")}},[t("div",{class:v("wrapper"),style:e},[this.genLeftPart(),this.slots(),this.genRightPart()])])}}),D=(n("68ef"),n("2221"),n("d399")),w=(n("e7e5"),n("bad1")),k=n("a8c1"),S=Object(u["a"])("calendar"),T=S[0],C=S[1],O=S[2],x=64;function $(t){return O("monthTitle",t.getFullYear(),t.getMonth()+1)}function R(t,e){var n=t.getFullYear(),i=e.getFullYear(),s=t.getMonth(),a=e.getMonth();return n===i?s===a?0:s>a?1:-1:n>i?1:-1}function B(t,e){var n=R(t,e);if(0===n){var i=t.getDate(),s=e.getDate();return i===s?0:i>s?1:-1}return n}function j(t,e){return t=new Date(t),t.setDate(t.getDate()+e),t}function M(t){return j(t,-1)}function A(t){return j(t,1)}function I(t){var e=t[0].getTime(),n=t[1].getTime();return(n-e)/864e5+1}function W(t){return Array.isArray(t)?t.map((function(t){return null===t?t:new Date(t)})):new Date(t)}var _,E=n("e41f"),F=n("b650"),H=n("96b0"),P=Object(u["a"])("calendar-month"),L=P[0],K=L({props:{date:Date,type:String,color:String,minDate:Date,maxDate:Date,showMark:Boolean,rowHeight:[Number,String],formatter:Function,currentDate:[Date,Array],showSubtitle:Boolean,showMonthTitle:Boolean},data:function(){return{visible:!1}},computed:{title:function(){return $(this.date)},offset:function(){return this.date.getDay()},totalDay:function(){return Object(H["a"])(this.date.getFullYear(),this.date.getMonth()+1)},monthStyle:function(){if(!this.visible){var t=Math.ceil((this.totalDay+this.offset)/7)*this.rowHeight;return{paddingBottom:t+"px"}}},days:function(){for(var t=[],e=this.date.getFullYear(),n=this.date.getMonth(),i=1;i<=this.totalDay;i++){var s=new Date(e,n,i),a=this.getDayType(s),r={date:s,type:a,text:i,bottomInfo:this.getBottomInfo(a)};this.formatter&&(r=this.formatter(r)),t.push(r)}return t}},mounted:function(){this.height=this.$el.getBoundingClientRect().height},methods:{scrollIntoView:function(){this.showSubtitle?this.$refs.days.scrollIntoView():this.$refs.month.scrollIntoView()},getMultipleDayType:function(t){var e=this,n=function(t){return e.currentDate.some((function(e){return 0===B(e,t)}))};if(n(t)){var i=M(t),s=A(t),a=n(i),r=n(s);return a&&r?"multiple-middle":a?"end":r?"start":"multiple-selected"}return""},getRangeDayType:function(t){var e=this.currentDate,n=e[0],i=e[1];if(n){var s=B(t,n);if(0===s)return"start";if(i){var a=B(t,i);return 0===a?"end":s>0&&a<0?"middle":void 0}}},getDayType:function(t){var e=this.type,n=this.minDate,i=this.maxDate,s=this.currentDate;return B(t,n)<0||B(t,i)>0?"disabled":"single"===e?0===B(t,s)?"selected":"":"multiple"===e?this.getMultipleDayType(t):"range"===e?this.getRangeDayType(t):void 0},getBottomInfo:function(t){if("range"===this.type){if("start"===t)return O("start");if("end"===t)return O("end")}},getDayStyle:function(t,e){var n={};return 0===e&&(n.marginLeft=100*this.offset/7+"%"),this.rowHeight!==x&&(n.height=this.rowHeight+"px"),this.color&&("start"===t||"end"===t||"multiple-selected"===t||"multiple-middle"===t?n.background=this.color:"middle"===t&&(n.color=this.color)),n},genTitle:function(){var t=this.$createElement;if(this.showMonthTitle)return t("div",{class:C("month-title")},[this.title])},genMark:function(){var t=this.$createElement;if(this.showMark)return t("div",{class:C("month-mark")},[this.date.getMonth()+1])},genDays:function(){var t=this.$createElement;return this.visible?t("div",{ref:"days",attrs:{role:"grid"},class:C("days")},[this.genMark(),this.days.map(this.genDay)]):t("div",{ref:"days"})},genDay:function(t,e){var n=this,i=this.$createElement,s=t.type,a=t.topInfo,r=t.bottomInfo,o=this.getDayStyle(s,e),l="disabled"===s,c=function(){l||n.$emit("click",t)},u=a&&i("div",{class:C("top-info")},[a]),h=r&&i("div",{class:C("bottom-info")},[r]);return"selected"===s?i("div",{attrs:{role:"gridcell",tabindex:l?null:-1},style:o,class:[C("day"),t.className],on:{click:c}},[i("div",{class:C("selected-day"),style:{background:this.color}},[u,t.text,h])]):i("div",{attrs:{role:"gridcell",tabindex:l?null:-1},style:o,class:[C("day",s),t.className],on:{click:c}},[u,t.text,h])}},render:function(){var t=arguments[0];return t("div",{class:C("month"),ref:"month",style:this.monthStyle},[this.genTitle(),this.genDays()])}}),N=Object(u["a"])("calendar-header"),U=N[0],V=U({props:{title:String,subtitle:String,showTitle:Boolean,showSubtitle:Boolean},methods:{genTitle:function(){var t=this.$createElement;if(this.showTitle){var e=this.slots("title")||this.title||O("title");return t("div",{class:C("header-title")},[e])}},genSubtitle:function(){var t=this.$createElement;if(this.showSubtitle)return t("div",{class:C("header-subtitle")},[this.subtitle])},genWeekDays:function(){var t=this.$createElement,e=O("weekdays");return t("div",{class:C("weekdays")},[e.map((function(e){return t("span",{class:C("weekday")},[e])}))])}},render:function(){var t=arguments[0];return t("div",{class:C("header")},[this.genTitle(),this.genSubtitle(),this.genWeekDays()])}}),Y=T({props:{title:String,color:String,value:Boolean,formatter:Function,confirmText:String,rangePrompt:String,defaultDate:[Date,Array],getContainer:[String,Function],closeOnPopstate:Boolean,confirmDisabledText:String,type:{type:String,default:"single"},minDate:{type:Date,validator:w["a"],default:function(){return new Date}},maxDate:{type:Date,validator:w["a"],default:function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth()+6,t.getDate())}},position:{type:String,default:"bottom"},rowHeight:{type:[Number,String],default:x},round:{type:Boolean,default:!0},poppable:{type:Boolean,default:!0},showMark:{type:Boolean,default:!0},showTitle:{type:Boolean,default:!0},showConfirm:{type:Boolean,default:!0},showSubtitle:{type:Boolean,default:!0},safeAreaInsetBottom:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0},maxRange:{type:[Number,String],default:null}},data:function(){return{subtitle:"",currentDate:this.getInitialDate()}},computed:{months:function(){var t=[],e=new Date(this.minDate);e.setDate(1);do{t.push(new Date(e)),e.setMonth(e.getMonth()+1)}while(1!==R(e,this.maxDate));return t},buttonDisabled:function(){var t=this.type,e=this.currentDate;return"range"===t?!e[0]||!e[1]:"multiple"===t?!e.length:!e}},watch:{type:"reset",value:function(t){t&&(this.initRect(),this.scrollIntoView())},defaultDate:function(t){this.currentDate=t,this.scrollIntoView()}},mounted:function(){!this.value&&this.poppable||(this.initRect(),this.scrollIntoView())},methods:{reset:function(){this.currentDate=this.getInitialDate(),this.scrollIntoView()},initRect:function(){var t=this;this.$nextTick((function(){t.bodyHeight=Math.floor(t.$refs.body.getBoundingClientRect().height),t.onScroll()}))},scrollIntoView:function(){var t=this;this.$nextTick((function(){var e=t.currentDate,n="single"===t.type?e:e[0],i=t.value||!t.poppable;n&&i&&t.months.some((function(e,i){return 0===R(e,n)&&(t.$refs.months[i].scrollIntoView(),!0)}))}))},getInitialDate:function(){var t=this.type,e=this.defaultDate,n=this.minDate;if("range"===t){var i=e||[],s=i[0],a=i[1];return[s||n,a||A(n)]}return"multiple"===t?[e||n]:e||n},onScroll:function(){var t=this.$refs,e=t.body,n=t.months,i=Object(k["c"])(e),s=i+this.bodyHeight,a=n.map((function(t){return t.height})),r=a.reduce((function(t,e){return t+e}),0);if(!(i<0||s>r&&i>0)){for(var o,l=0,c=0;c<n.length;c++){var u=l<=s&&l+a[c]>=i;u&&!o&&(o=n[c]),n[c].visible=u,l+=a[c]}o&&(this.subtitle=o.title)}},onClickDay:function(t){var e=t.date,n=this.type,i=this.currentDate;if("range"===n){var s=i[0],a=i[1];if(s&&!a){var r=B(e,s);1===r?this.select([s,e],!0):-1===r&&this.select([e,null])}else this.select([e,null])}else if("multiple"===n){var o,l=this.currentDate.some((function(t,n){var i=0===B(t,e);return i&&(o=n),i}));l?i.splice(o,1):this.select([].concat(i,[e]))}else this.select(e,!0)},togglePopup:function(t){this.$emit("input",t)},select:function(t,e){if(this.currentDate=t,this.$emit("select",W(this.currentDate)),e&&"range"===this.type){var n=this.checkRange();if(!n)return}e&&!this.showConfirm&&this.onConfirm()},checkRange:function(){var t=this.maxRange,e=this.currentDate,n=this.rangePrompt;return!(t&&I(e)>t)||(Object(D["a"])(n||O("rangePrompt",t)),!1)},onConfirm:function(){("range"!==this.type||this.checkRange())&&this.$emit("confirm",W(this.currentDate))},genMonth:function(t,e){var n=this.$createElement,i=0!==e||!this.showSubtitle;return n(K,{ref:"months",refInFor:!0,attrs:{date:t,type:this.type,color:this.color,minDate:this.minDate,maxDate:this.maxDate,showMark:this.showMark,formatter:this.formatter,rowHeight:this.rowHeight,currentDate:this.currentDate,showSubtitle:this.showSubtitle,showMonthTitle:i},on:{click:this.onClickDay}})},genFooterContent:function(){var t=this.$createElement,e=this.slots("footer");if(e)return e;if(this.showConfirm){var n=this.buttonDisabled?this.confirmDisabledText:this.confirmText;return t(F["a"],{attrs:{round:!0,block:!0,type:"danger",color:this.color,disabled:this.buttonDisabled,nativeType:"text"},class:C("confirm"),on:{click:this.onConfirm}},[n||O("confirm")])}},genFooter:function(){var t=this.$createElement;return t("div",{class:C("footer",{"safe-area-inset-bottom":this.safeAreaInsetBottom})},[this.genFooterContent()])},genCalendar:function(){var t=this,e=this.$createElement;return e("div",{class:C()},[e(V,{attrs:{title:this.title,showTitle:this.showTitle,subtitle:this.subtitle,showSubtitle:this.showSubtitle},scopedSlots:{title:function(){return t.slots("title")}}}),e("div",{ref:"body",class:C("body"),on:{scroll:this.onScroll}},[this.months.map(this.genMonth)]),this.genFooter()])}},render:function(){var t=this,e=arguments[0];if(this.poppable){var n,i=function(e){return function(){return t.$emit(e)}};return e(E["a"],{attrs:(n={round:!0,value:this.value},n["round"]=this.round,n["position"]=this.position,n["closeable"]=this.showTitle||this.showSubtitle,n["getContainer"]=this.getContainer,n["closeOnPopstate"]=this.closeOnPopstate,n["closeOnClickOverlay"]=this.closeOnClickOverlay,n),class:C("popup"),on:{input:this.togglePopup,open:i("open"),opened:i("opened"),close:i("close"),closed:i("closed")}},[this.genCalendar()])}return this.genCalendar()}}),q=(n("a71a"),n("9d70"),n("3743"),n("4d75"),n("e3b3"),n("bc1b"),n("b258"),n("819b"),n("2241")),z=(n("e17f"),n("4862")),J=n("93f3"),X=n("afbc"),G=n("2f62"),Q=new Date,Z=l["a"].extend({name:"task",data:function(){return{isLoading:!1,timerId:0,defaultDate:Q,minDate:new Date(Q.getTime()-2592e6),maxDate:Q,isCalendar:!1,isSwiping:!1,TASK_STATUS:J["g"]}},methods:{onTaskRefresh:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,z["a"].viewTasks();case 2:n=e.sent,Object(D["a"])(n.code===J["f"].success?"刷新成功":n.msg),t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})))()},onTaskClick:function(t){this.isSwiping?this.isSwiping=!1:this.$router.push("".concat(X["a"].taskDetail,"/").concat(t))},onDateTimeClick:function(){this.isCalendar=!0},onCalendarConfirm:function(){this.isCalendar=!1},onSwipeCellOpen:function(){this.isSwiping=!0},onSwipeCellClose:function(){this.isSwiping=!1},onAddTaskClick:function(){this.$router.push(X["a"].addTask)},onSwipeRightClick:function(t,e){return Object(o["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,q["a"].confirm({title:J["i"][t]});case 2:return n.next=4,z["a"].updateTaskStatus(e,t);case 4:i=n.sent,Object(D["a"])(i.code===J["f"].success?"更新成功":i.msg);case 6:case"end":return n.stop()}}),n)})))()},getTasks:function(){return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z["a"].viewTasks();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),console.log(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()}},created:function(){this.getTasks()},components:(_={},Object(r["a"])(_,c["a"].name,c["a"]),Object(r["a"])(_,y.name,y),Object(r["a"])(_,Y.name,Y),_),computed:Object(a["a"])({},Object(G["b"])(["tasks"]))}),tt=Z,et=(n("97e0"),n("2877")),nt=Object(et["a"])(tt,i,s,!1,null,"66d158c2",null);e["default"]=nt.exports},"819b":function(t,e,n){},"96b0":function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return r}));var i=n("90c6");function s(t,e){var n=-1,i=Array(t);while(++n<t)i[n]=e(n);return i}function a(t){if(!t)return 0;while(Object(i["a"])(parseInt(t,10))){if(!(t.length>1))return 0;t=t.slice(1)}return parseInt(t,10)}function r(t,e){return 32-new Date(t,e-1,32).getDate()}},"97e0":function(t,e,n){"use strict";var i=n("26f2"),s=n.n(i);s.a},bad1:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("90c6");function s(t){return"[object Date]"===Object.prototype.toString.call(t)&&!Object(i["a"])(t.getTime())}},ea47:function(t,e,n){"use strict";var i=n("2638"),s=n.n(i),a=n("d282"),r=n("ba31"),o=n("b1d2"),l=n("7744"),c=n("34e9"),u=Object(a["a"])("panel"),h=u[0],f=u[1];function d(t,e,n,i){var a=function(){return[n.header?n.header():t(l["a"],{attrs:{icon:e.icon,label:e.desc,title:e.title,value:e.status,valueClass:f("header-value")},class:f("header")}),t("div",{class:f("content")},[n.default&&n.default()]),n.footer&&t("div",{class:[f("footer"),o["d"]]},[n.footer()])]};return t(c["a"],s()([{class:f(),scopedSlots:{default:a}},Object(r["b"])(i,!0)]))}d.props={icon:String,desc:String,title:String,status:String},e["a"]=h(d)}}]);
//# sourceMappingURL=chunk-784fe62f.8593c4cc.js.map