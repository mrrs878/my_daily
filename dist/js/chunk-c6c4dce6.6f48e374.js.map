{"version":3,"sources":["webpack:///./src/views/auth/Login.vue?9c98","webpack:///./src/views/auth/Login.vue","webpack:///./src/views/auth/Login.vue?b794","webpack:///./src/views/auth/Login.vue?775d","webpack:///./src/api/auth.ts","webpack:///./src/module/auth.ts","webpack:///./src/assets/img/github.svg","webpack:///./src/views/auth/Login.vue?e2c8"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","onNavBarClickLeft","model","value","callback","$$v","name","expression","password","$event","onAuthActionClick","_v","onLoginBtnClick","onGithubLoginClick","staticRenderFns","extend","data","methods","ToastError","loading","login","res","clear","$router","back","msg","type","push","forgetPwd","register","window","location","href","component","LOGIN_API","ajax","post","get","code","success","updateToken","Promise","resolve","console","log","store","dispatch","updateUser","localStorage","setItem","tokenName","token","logout","removeItem","User","updateTasks","loginByGithub","module","exports"],"mappings":"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","file":"js/chunk-c6c4dce6.6f48e374.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('van-nav-bar',{attrs:{\"left-text\":\"登录\",\"left-arrow\":\"\"},on:{\"click-left\":_vm.onNavBarClickLeft}}),_c('div',{staticClass:\"login-info-container\"},[_c('van-field',{attrs:{\"clearable\":\"\",\"placeholder\":\"请输入账号\"},model:{value:(_vm.name),callback:function ($$v) {_vm.name=$$v},expression:\"name\"}}),_c('van-field',{attrs:{\"type\":\"password\",\"clearable\":\"\",\"autosize\":\"\",\"placeholder\":\"请输入密码\"},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}}),_c('br'),_c('div',{staticClass:\"auth-action-container padding-h\"},[_c('span',{on:{\"click\":function($event){return _vm.onAuthActionClick('forgetPwd')}}},[_vm._v(\"忘记密码?\")]),_c('span',{on:{\"click\":function($event){return _vm.onAuthActionClick('register')}}},[_vm._v(\"注册\")])]),_c('br'),_c('br'),_c('van-button',{staticClass:\"login-btn\",attrs:{\"size\":\"large\",\"type\":\"primary\"},on:{\"click\":_vm.onLoginBtnClick}},[_vm._v(\"登录\")])],1),_c('div',{staticClass:\"login-helpers\"},[_c('img',{staticClass:\"login-type\",attrs:{\"src\":require(\"../../assets/img/github.svg\"),\"alt\":\"\"},on:{\"click\":_vm.onGithubLoginClick}})])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Vue from 'vue'\r\nimport ToastError from '@/models/ToastError'\r\nimport { Toast } from 'vant'\r\nimport AuthModule from '@/module/auth'\r\nimport { ROUTES_MAP } from '@/router'\r\n\r\nexport default Vue.extend({\r\n  name: 'login',\r\n  data: () => ({\r\n    name: '',\r\n    password: ''\r\n  }),\r\n  methods: {\r\n    async onLoginBtnClick () {\r\n      try {\r\n        const { name, password } = this\r\n        if (name === '') throw new ToastError('请输入账号')\r\n        if (password === '') throw new ToastError('请输入密码')\r\n        Toast.loading('登录中...')\r\n        const res = await AuthModule.login({ name, password })\r\n        if (res) {\r\n          Toast.clear(true)\r\n          this.$router.back()\r\n        }\r\n      } catch (e) {\r\n        if (e instanceof ToastError) Toast(e.msg)\r\n      }\r\n    },\r\n    onAuthActionClick (type: string) {\r\n      this.$router.push(type === 'forgetPwd' ? ROUTES_MAP.forgetPwd : ROUTES_MAP.register)\r\n    },\r\n    onGithubLoginClick () {\r\n      window.location.href = 'https://github.com/login/oauth/authorize?client_id=7b961b417e4b3fc83488&scope=user,public_repo'\r\n    }\r\n  }\r\n})\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=7ba369ad&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=ts&\"\nexport * from \"./Login.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=7ba369ad&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7ba369ad\",\n  null\n  \n)\n\nexport default component.exports","import { BASE_API } from './index'\r\nimport { AjaxResponseI, LoginReqI } from '@/interface/ajax'\r\nimport ajax from '@/util/ajax'\r\nimport { UserI } from '@/interface/model'\r\n\r\nconst LOGIN_API = `${ BASE_API }/auth`\r\n\r\nexport const LOGIN = (data: LoginReqI): Promise<AjaxResponseI<UserI>> => ajax.post(`${LOGIN_API}/login`, data)\r\nexport const REGISTER = (data: LoginReqI): Promise<AjaxResponseI<UserI>> => ajax.post(`${LOGIN_API}/register`, data)\r\nexport const LOGIN_BY_GITHUB = (data: string): Promise<AjaxResponseI<any>> => ajax.get(`${LOGIN_API}/github/${data}`)\r\n","import { LoginReqI } from '@/interface/ajax'\r\nimport {LOGIN, LOGIN_BY_GITHUB, REGISTER} from '@/api/auth'\r\nimport { Toast } from 'vant'\r\nimport {MSG_TYPE, RES_CODE} from '@/constant'\r\nimport store from '@/store'\r\nimport { ACTIONS_E } from '@/store/actions'\r\nimport CONFIG from '@/config'\r\nimport User from '@/models/User'\r\nimport { postMessage } from '@/worker/alarm'\r\nimport {UserI} from \"@/interface/model\";\r\n\r\nexport default {\r\n  async login (data: LoginReqI) {\r\n    try {\r\n      const res = await LOGIN(data)\r\n      Toast(res.msg)\r\n      if (res.code === RES_CODE.success) {\r\n        this.updateToken(res.data)\r\n      }\r\n      return Promise.resolve(res.code === RES_CODE.success)\r\n    } catch (e) {\r\n      console.log(e)\r\n      return Promise.resolve(false)\r\n    }\r\n  },\r\n  async updateToken (data: UserI) {\r\n    await store.dispatch(ACTIONS_E.updateUser, data)\r\n    localStorage.setItem(CONFIG.tokenName, data.token)\r\n    postMessage<string>({ type: MSG_TYPE.token, msg: data.token })\r\n  },\r\n  async logout () {\r\n    localStorage.removeItem(CONFIG.tokenName)\r\n    await store.dispatch(ACTIONS_E.updateUser, new User())\r\n    await store.dispatch(ACTIONS_E.updateTasks, [])\r\n    return Promise.resolve(true)\r\n  },\r\n  async register (data: LoginReqI) {\r\n    try {\r\n      const res = await REGISTER(data)\r\n      Toast(res.msg)\r\n      return Promise.resolve(res.code === RES_CODE.success)\r\n    } catch (e) {\r\n      console.log(e)\r\n      return Promise.resolve(false)\r\n    }\r\n  },\r\n  async loginByGithub (code: string): Promise<UserI | null> {\r\n    try {\r\n      const res = await LOGIN_BY_GITHUB(code)\r\n      return Promise.resolve(res.data)\r\n    } catch (e) {\r\n      console.log(e)\r\n      return Promise.resolve(null)\r\n    }\r\n  }\r\n}\r\n","module.exports = __webpack_public_path__ + \"img/github.dc77bc7f.svg\";","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=7ba369ad&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=7ba369ad&lang=less&scoped=true&\""],"sourceRoot":""}